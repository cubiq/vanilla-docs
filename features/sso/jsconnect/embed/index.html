<!DOCTYPE html><html lang=en manifest=/manifest.appcache><head><meta charset=utf-8><title>Embedded &middot; Vanilla Documentation</title><meta name=description content=""><meta name=keywords content=""><meta name=viewport content="width=device-width"><meta name=google-site-verification content=IWfWjN_f_82e7heCa9D0SJRhIf8aZdPNKZm_ympcB54><link rel=stylesheet href=/assets/main.6ca85029.css><body><div id=top></div><nav class="navbar navbar-default navbar-static-top" role=navigation><div class=container><div class=navbar-header><a class=navbar-brand href="/"><img class=logo src=/assets/img/logo.9bdefa97.svg alt="Vanilla Forums" width=102 height=41> Docs</a></div><div class="collapse navbar-collapse"><div class="navbar-form navbar-left"><div class="dropdown js-search" role=search><div class=form-group><input class="form-control js-search-input" id=docs-search title="Search the documentation" placeholder=Search></div><ul class="dropdown-menu dropdown-search-results js-search-results"><li><a><span class=title></span> <span class=categories></span></a></li></ul></div></div><ul class="nav navbar-nav navbar-right"><li><a href=http://vanillaforums.com>Cloud Hosted Community</a></li><li><a href=http://vanillaforums.org>Open Source Community</a></li></ul></div></div></nav><div class=container><ol class=breadcrumb><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/" itemprop=url><span itemprop=title>Home</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/features/" itemprop=url><span itemprop=title>Features</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/features/sso/" itemprop=url><span itemprop=title>Single Sign-On (SSO)</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/features/sso/jsconnect/" itemprop=url><span itemprop=title>SSO with jsConnect</span></a></li><li class=active itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span itemprop=title>Embedded</span></li></ol><div class=row><div class=col-sm-3><nav class="docs-nav js-docs-nav" role=navigation><ul class="nav nav-stacked"><li><a href="/addons/">Addons</a><ul class="nav nav-stacked"><li><a href="/addons/badges/">Badges</a><ul class="nav nav-stacked"><li><a href="/addons/badges/adding-and-editing-badges/">Adding and Editing Badges</a></li><li><a href="/addons/badges/giving-and-requesting-badges/">Giving and Requesting Badges</a></li></ul></li><li><a href="/addons/warnings-and-notes/">Warnings &amp; Notes</a><ul class="nav nav-stacked"><li><a href="/addons/warnings-and-notes/adding-and-editing-user-notes/">Adding and Editing User Notes</a></li><li><a href="/addons/warnings-and-notes/upgrading-from-warnings/">Upgrading from Warnings</a></li><li><a href="/addons/warnings-and-notes/warning-a-user/">Warning a User</a></li></ul></li><li><a href="/addons/gigya/">Gigya Sign In</a></li><li><a href="/addons/googleplus/">Google Plus</a></li><li><a href="/addons/groups/">Groups</a><ul class="nav nav-stacked"><li><a href="/addons/groups/managing-groups/">Managing Groups</a></li></ul></li><li><a href="/addons/pockets/">Pockets</a></li><li><a href="/addons/forummerge/">Forum Merge</a></li><li><a href="/addons/reactions/">Reactions</a><ul class="nav nav-stacked"><li><a href="/addons/reactions/adding-and-editing-reactions/">Adding and Editing Reactions</a></li><li><a href="/addons/reactions/curating-with-reactions/">Curating with Reactions</a></li></ul></li><li><a href="/addons/redirector/">Redirector</a></li><li><a href="/addons/reporting/">Reporting</a></li><li><a href="/addons/statistics/">Statistics</a></li><li><a href="/addons/vanilla-pop/">Vanilla Pop</a></li><li><a href="/addons/ranks/">Ranks</a><ul class="nav nav-stacked"><li><a href="/addons/ranks/adding-and-editing-ranks/">Adding and Editing Ranks</a></li><li><a href="/addons/ranks/applying-ranks-over-sso/">Applying Ranks over SSO</a></li><li><a href="/addons/ranks/using-ranks-as-incentives/">Using Ranks as Incentives</a></li><li><a href="/addons/ranks/using-ranks-to-defeat-spam-or-abuse/">Using Ranks to Defeat Spam or Abuse</a></li></ul></li></ul></li><li><a href="/api/">API</a><ul class="nav nav-stacked"><li><a href="/api/smart-id/">Smart ID</a></li><li><a href="/api/categories/">Categories</a></li><li><a href="/api/comments/">Comments</a></li><li><a href="/api/discussions/">Discussions</a></li><li><a href="/api/forum-administration/">Forum Administration</a></li><li><a href="/api/site-hub/">Site Hub</a></li><li><a href="/api/use-api-on-external-site/">API on External Sites</a></li></ul></li><li><a href="/cloud/">Cloud Services</a><ul class="nav nav-stacked"><li><a href="/cloud/integration/">Integration Services</a></li><li><a href="/cloud/migration/">Migration Services</a></li><li><a href="/cloud/repo/">Repository</a></li><li><a href="/cloud/ssl/">Setting up SSL (https)</a></li><li><a href="/cloud/staging/">Staging Site</a></li><li><a href="/cloud/support/">Support</a></li><li><a href="/cloud/theming/">Theming Services</a></li></ul></li><li><a href="/developers/">Developers</a><ul class="nav nav-stacked"><li><a href="/developers/changelog/">Changelog</a></li><li><a href="/developers/troubleshooting/">Troubleshooting</a></li><li><a href="/developers/configuration/">Configuration</a><ul class="nav nav-stacked"><li><a href="/developers/configuration/banner/">Banner Settings</a></li><li><a href="/developers/configuration/dashboard/">Dashboard</a></li><li><a href="/developers/configuration/homepage/">Homepage Settings</a></li><li><a href="/developers/configuration/message/">Messages</a></li><li><a href="/developers/configuration/using/">Using The Config</a></li></ul></li><li><a href="/developers/contributing/">Contributing</a><ul class="nav nav-stacked"><li><a href="/developers/contributing/coding-standard/">Coding Standard</a></li><li><a href="/developers/contributing/pull-requests/">Pull Requests</a></li></ul></li><li><a href="/developers/framework/">Framework</a><ul class="nav nav-stacked"><li><a href="/developers/framework/assets/">Assets</a></li><li><a href="/developers/framework/views/">Views</a></li><li><a href="/developers/framework/database/">Database access</a></li><li><a href="/developers/framework/datasets/">Datasets</a></li><li><a href="/developers/framework/events/">Events</a></li><li><a href="/developers/framework/forms/">Forms</a></li><li><a href="/developers/framework/helpers/">Helpers</a></li><li><a href="/developers/framework/controllers/">Controllers &amp; URLs</a></li><li><a href="/developers/framework/inform/">Inform Notifications</a></li><li><a href="/developers/framework/models/">Models and Forms</a></li><li><a href="/developers/framework/modules/">Modules</a></li><li><a href="/developers/framework/permissions/">Permissions</a></li><li><a href="/developers/framework/requests/">Requests</a></li><li><a href="/developers/framework/i18n/">Internationalization &amp; Localization</a></li></ul></li><li><a href="/developers/importing/">Importing</a><ul class="nav nav-stacked"><li><a href="/developers/importing/build/">Building new porters</a></li><li><a href="/developers/importing/porter/">Vanilla Porter</a></li><li><a href="/developers/importing/support/">Supported platforms</a></li></ul></li><li><a href="/developers/community/">Community</a></li><li><a href="/developers/locales/">Locales</a></li><li><a href="/developers/plugins/">Plugins</a><ul class="nav nav-stacked"><li><a href="/developers/plugins/quickstart/">Plugin Quickstart</a></li></ul></li><li><a href="/developers/routes/">Routes</a></li><li><a href="/developers/tools/">Developer Tools</a></li><li><a href="/developers/installation/">Installation</a></li></ul></li><li class=active><a href="/features/">Features</a><ul class="nav nav-stacked"><li><a href="/features/categories/">Categories</a></li><li><a href="/features/embedding/">Embedding</a><ul class="nav nav-stacked"><li><a href="/features/embedding/advanced/">Advanced Embedding</a></li></ul></li><li><a href="/features/emoji/">Emoji</a></li><li><a href="/features/roles-permissions/">Roles &amp; Permissions</a><ul class="nav nav-stacked"><li><a href="/features/roles-permissions/default-role-types/">Default Role Types</a></li></ul></li><li class=active><a href="/features/sso/">Single Sign-On (SSO)</a><ul class="nav nav-stacked"><li class=active><a href="/features/sso/jsconnect/">SSO with jsConnect</a><ul class="nav nav-stacked"><li class=active><a href="/features/sso/jsconnect/embed/">Embedded</a></li><li><a href="/features/sso/jsconnect/overview/">Technical Overview</a></li><li><a href="/features/sso/jsconnect/seamless/">Seamless Setup</a></li></ul></li><li><a href="/features/sso/oauth/">SSO with OAuth</a></li><li><a href="/features/sso/saml/">SSO with SAML</a></li></ul></li><li><a href="/features/wordpress/">WordPress Integration</a><ul class="nav nav-stacked"><li><a href="/features/wordpress/using-comments/">Using Comments</a></li><li><a href="/features/wordpress/wishlist/">WishList Integration</a></li></ul></li></ul></li><li><a href="/theming/">Theming</a><ul class="nav nav-stacked"><li><a href="/theming/css/">Theming CSS</a></li><li><a href="/theming/hooks/">Theming Hooks</a></li><li><a href="/theming/quickstart/">Theming Quickstart</a></li><li><a href="/theming/smarty/">Smarty</a><ul class="nav nav-stacked"><li><a href="/theming/smarty/asset/">{asset}</a></li><li><a href="/theming/smarty/text/">{text}</a></li><li><a href="/theming/smarty/custom-menu/">{custom_menu}</a></li><li><a href="/theming/smarty/event/">{event}</a></li><li><a href="/theming/smarty/i18n/">{t}</a></li><li><a href="/theming/smarty/link/">{link}</a></li><li><a href="/theming/smarty/breadcrumbs/">{breadcrumbs}</a></li><li><a href="/theming/smarty/mobile-logo/">{mobile_logo}</a></li><li><a href="/theming/smarty/permission/">{permission}</a></li><li><a href="/theming/smarty/pocket/">{pocket}</a></li><li><a href="/theming/smarty/searchbox/">{searchbox}</a></li><li><a href="/theming/smarty/logo/">{logo}</a></li></ul></li><li><a href="/theming/views/">Theming Views</a></li></ul></li></ul><p class=hidden-xs><a class=text-muted href=#top>^ Back to top</a></p></nav></div><div class=col-sm-9><div class="edit-doc pull-right hidden-xs"><a class="btn btn-default btn-xs" href=https://github.com/vanilla/vanilladocs/edit/master/docs/features/sso/jsconnect/embed.html.md>Improve document</a></div><article class=markdown-body role=article><h2 id=embedding-with-seamless-jsconnect>Embedding with Seamless jsConnect</h2><p><a title="jsConnect Technical Documentation Part 1: Site-Wide SSO" href="http://blog.vanillaforums.com/implementing-jsconnect/jsconnect-technical-documentation/">Part 1</a> of this documentation told you how to set up jsConnect SSO for site-wide SSO. However, if you have Vanilla embedded in a page you&#39;ll notice that the SSO doesn&#39;t automatically sign you in even if users are signed in to the containing page. In order to make the sign in seamless you need to add some SSO information to your embed code.</p><p>First, we&#39;ll address another important issue: Mobile Safari. <strong>Attempting embedded SSO across two domains will not work in this browser (and therefore, on all Apple devices)</strong>.</p><p>To solve this, your forum must be hosted on a subdomain of your main site. For example, if your site is url.com, you could put your forum on forum.url.com, and then embed it from there. This sidesteps Mobile Safari&#39;s issue, and potentially increases your search engine value as well. Our clients can change their forum to a subdomain of their site by going to &quot;Customize Domain&quot; in their Dashboard and following the instructions there.</p><p>Now, on to revising your embed code with some additional SSO information.</p><h2 id=vanilla-embed-code>Vanilla Embed Code</h2><p>Consider the embed code for Vanilla comments:</p><pre class=highlight><code class="hljs dart">&amp;lt;script type=<span class=hljs-string>"text/javascript"</span>&amp;gt;

<span class=hljs-dartdoc><span class=markdown>/<span class=hljs-strong>*** Required Settings: Edit BEFORE pasting into your web page **</span>*/</span></span>

<span class=hljs-keyword>var</span> vanilla_forum_url = <span class=hljs-string>'http://your.url.com/'</span>; <span class=hljs-comment>// The full http url &amp;amp; path to your vanilla forum</span>
<span class=hljs-keyword>var</span> vanilla_identifier = <span class=hljs-string>'your-content-identifier'</span>; <span class=hljs-comment>// Your unique identifier for the content being commented on</span>
&lt;strong&gt;<span class=hljs-keyword>var</span> vanilla_sso = <span class=hljs-string>'SSO STRING'</span>; <span class=hljs-comment>// Your SSO string.&lt;/strong&gt;</span>

<span class=hljs-dartdoc><span class=markdown>/<span class=hljs-strong>*** DON'T EDIT BELOW THIS LINE **</span>*/</span></span>

(function() {
<span class=hljs-keyword>var</span> vanilla = <span class=hljs-built_in>document</span>.createElement(<span class=hljs-string>'script'</span>);
vanilla.type = <span class=hljs-string>'text/javascript'</span>;
<span class=hljs-keyword>var</span> timestamp = <span class=hljs-keyword>new</span> Date().getTime();
vanilla.src = vanilla_forum_url + <span class=hljs-string>'/js/embed.js'</span>;

(<span class=hljs-built_in>document</span>.getElementsByTagName(<span class=hljs-string>'head'</span>)[<span class=hljs-number>0</span>] || <span class=hljs-built_in>document</span>.getElementsByTagName(<span class=hljs-string>'body'</span>)[<span class=hljs-number>0</span>]).appendChild(vanilla);
})();

&amp;lt;/script&amp;gt;
</code></pre><p>If you declare <strong>vanilla_sso</strong> and give it the proper value then Vanilla will be able to sign in your user. Here is what you need to do to generate your SSO string:</p><p><ol><li>Start with the signed in user. This has the same fields as the user from the <a title="jsConnect Technical Documentation Part 1: Site-Wide SSO" href="http://blog.vanillaforums.com/implementing-jsconnect/jsconnect-technical-documentation/">site-wide sso</a>.</li><li>Add your <strong>client_id</strong> to the user so Vanilla will know how to identify you.</li><li>JSON encode the user.</li><li>Base64 encode the user in UTF-8. This is your signature string.</li><li>Sign the signature string with your signature and the current timestamp using HMAC SHA1. Confirm the signature string is hex encoded.</li></ol></p><pre class=highlight><code class="hljs ini"><span class=hljs-setting>signature = <span class=hljs-value>hmacsha1(signature_string + <span class=hljs-string>" "</span> + timestamp, secret);</span></span>
</code></pre><p><li>Build your final sso string:</li></p><pre class=highlight><code class="hljs autohotkey">vanill<span class=hljs-built_in>a_sso</span> = signature_string + <span class=hljs-string>" "</span> + signature + <span class=hljs-string>" "</span> + timestamp + <span class=hljs-string>" hmacsha1"</span>
</code></pre><p>That&#39;s it! The value of vanilla_sso from above is what you put in your embed code. Since this needs to be dynamically generated by your site you can&#39;t use SSO on a static page.</p><p><h2>Gotchas</h2></p><p><ul><li>The above example is for blog comments. For a full forum embed, use the code provided under &quot;Forum Embed&quot; in the Dashboard.</li><li><span style=line-height:12.99px>Even though your signature string is base64 encoded make sure the actual signature is hex encoded. The correct string will be 40 characters consisting of the numbers 0-9 and a-f.</span></li><li>The timestamp is a unix timestamp. That means it will be an integer and represents the number of seconds since 1 January 1970. Most languages have a way of getting this timestamp.</li></ul>&nbsp;</p></article></div></div></div><footer class="footer js-footer"><div class=jumbotron><div class=container><div class=row><div class=col-sm-6><h3><a href=http://vanillaforums.com>Cloud Hosting</a></h3><p><strong>We believe that online communities should be intuitive, engaging and true to your brand.</strong> Vanilla allows you to create a customized community that rewards positive participation, automatically curates content and lets members drive moderation.</p></div><div class=col-sm-6><h3><a href=http://vanillaforums.org>Open Source</a></h3><p>Vanilla provides cloud and open source community forum software that powers discussion forums on more than 700,000 sites. Built for flexibility and integration, <strong>Vanilla is the best, most powerful community solution in the world.</strong></p></div></div></div></div><div class=footer-copyright><div class=container><p class=text-center>Copyright &copy; 2009-2015 <a href=http://vanillaforums.com>Vanilla Forums Inc.</a> All rights reserved.</p><ul class="list-inline text-center hidden-xs"><li><a href=http://docs.vanillaforums.com>Docs</a></li><li><a href=http://blog.vanillaforums.com>Blog</a></li><li><a href=http://vanillaforums.com>Cloud</a></li><li><a href=http://vanillaforums.org>Community</a></li><li><a href=https://github.com/vanilla>GitHub</a></li><li><a href=https://github.com/vanilla/vanilla/issues>Issues</a></li></ul></div></div></footer><script src=/search.3403dae2.json id=search-manifest type=application/json></script><script src=/assets/main.679204c0.js></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-12713112-1","auto"),ga("send","pageview");</script>